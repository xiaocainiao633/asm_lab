# USB 总线及挂载设备测试实验

## 1. 实验目的

本实验旨在通过读取、检测和操作计算机系统中的 USB 总线及其挂载设备，体验 USB 总线的属性和特点，掌握如何通过编程获取设备信息、检测设备状态，并对设备进行文件操作。实验的目标是：

- 学习并实现 USB 设备的检测与操作。
- 掌握基础的文件操作，向 USB 设备写入、拷贝和删除文件。
- 通过创新功能提升实验的可用性和用户体验，确保系统能够检测到设备的变化并提供实时反馈。
- 设计一个美观、直观的 GUI 界面，增强用户交互体验。

## 2. 基本功能

以下是实现的基本功能要求，确保系统的稳定性和完整性：

### 2.1 显示系统当前登录用户 ✓

- **描述**：程序能够显示当前计算机系统中登录的用户。
- **技术实现**：使用 `psutil` 或 `os` 库获取当前登录的用户信息。
- **状态**：✓ 已完成

### 2.2 检测系统中的 USB 设备及其信息 ✓

- **描述**：程序能够列出当前系统中所有挂载的 USB 设备及其信息，如设备制造商、序列号、总线编号和传输速度。
- **技术实现**：通过 PowerShell 和 WMI 获取设备详细信息，列出所有已连接的 USB 设备。
- **状态**：✓ 已完成（包含制造商、型号、序列号、接口类型、介质类型等完整信息）
- **实测结果**：成功检测到 aigo U350 设备，序列号 FC11095E6C42C

### 2.3 检测 USB 设备的插拔 ✓

- **描述**：程序能够实时监控 USB 设备的插入与拔出，并动态更新设备信息。
- **技术实现**：通过事件驱动或定时扫描 USB 设备的连接状态，实时监控设备的变化。
- **状态**：✓ 已完成（每 2 秒自动检测）

### 2.4 向 USB 设备（U 盘）写入数据 ✓

- **描述**：程序能够向 U 盘写入简单文本数据（例如创建一个文本文件，写入内容）。
- **技术实现**：通过 Python 的 `open()` 方法向 U 盘中写入文件。
- **状态**：✓ 已完成

### 2.5 向 U 盘拷贝文件 ✓

- **描述**：程序能够将本地文件拷贝到 U 盘。
- **技术实现**：使用 Python 的 `shutil.copy()` 方法实现文件的拷贝操作。
- **状态**：✓ 已完成（包含传输速率显示）

### 2.6 删除 U 盘中的文件 ✓

- **描述**：程序能够从 U 盘中删除指定文件。
- **技术实现**：使用 Python 的 `os.remove()` 或 `os.rmdir()` 方法进行文件删除操作。
- **状态**：✓ 已完成

## 3. 拓展功能

拓展功能的实现旨在提升系统的实用性和创新性，让实验展示更多的应用场景：

### 3.1 显示 U 盘中的文件列表（包括隐藏文件） ✓

- **描述**：程序能够显示 U 盘中的所有文件列表，包括隐藏文件。
- **技术实现**：使用 `os.listdir()` 获取 U 盘目录中的文件，并通过 Windows API 检查是否为隐藏文件。可在 UI 中实现文件的排序和过滤功能。
- **状态**：✓ 已完成（文件管理标签页）

### 3.2 实时传输速率显示 ✓

- **描述**：在文件传输过程中，程序能够实时显示传输的速率。
- **技术实现**：使用 `time` 库测量文件传输时间，实时更新文件传输速率，并在 GUI 中使用进度条或文本显示速率。
- **状态**：✓ 已完成（传输监控标签页）

### 3.3 动态更新 USB 设备状态 ✓

- **描述**：程序能够实时显示 USB 设备的连接状态，如设备插入、拔出、传输中等状态。
- **技术实现**：通过 `PyQt5` 等 GUI 库，动态更新设备列表并显示设备状态。设备状态可以通过不同的颜色或图标进行标识。
- **状态**：✓ 已完成（传输监控标签页，每 3 秒刷新）

### 3.4 文件管理系统（如支持文件夹操作、文件预览） ✓

- **描述**：扩展文件操作功能，支持文件夹操作（创建、删除、重命名）以及文件预览（如文本文件、图片文件）。
- **技术实现**：使用 Python 的 `os.makedirs()` 和 `os.rename()` 实现文件夹操作；使用 `PIL` 库进行图片预览，或通过 `open()` 显示文本文件内容。
- **状态**：✓ 已完成（文件管理标签页，支持创建、重命名、删除、预览）

### 3.5 智能提示与错误处理 ✓

- **描述**：程序能够在操作失败时给出详细且用户友好的提示，例如文件路径错误、权限问题等。
- **技术实现**：通过 `QMessageBox` 在 GUI 中显示错误提示，提醒用户操作过程中遇到的具体问题。
- **状态**：✓ 已完成（所有功能模块均包含错误处理）

## 4. 界面优化 ✓

为提升用户体验和界面美观度，以下是界面优化方面的设计：

### 4.1 界面设计 ✓

- **目标**：设计现代化、简洁且直观的用户界面，确保用户能够方便地进行 USB 设备操作和文件管理。
- **实现**：
  - 使用 `PyQt5` 创建图形界面
  - 采用多标签页布局，功能分类清晰
  - 卡片式设计，层次分明
  - 现代化配色方案（渐变色、阴影效果）
- **状态**：✓ 已完成

### 4.2 动态交互效果 ✓

- **目标**：增强用户交互感，让界面更加生动和直观。
- **实现**：
  - 按钮悬停效果（颜色变化、阴影）
  - 按钮按下效果（视觉位移）
  - 列表项选中高亮（渐变背景、左边框）
  - 输入框焦点效果（边框变色）
  - 进度条渐变动画
- **状态**：✓ 已完成

### 4.3 用户反馈与提示 ✓

- **目标**：在操作过程中，提供清晰的用户反馈，确保用户能够随时了解操作状态。
- **实现**：
  - 详细的错误提示对话框
  - 操作成功的确认信息
  - 实时状态栏更新
  - 操作日志记录
  - 颜色标识（成功-绿色、警告-橙色、错误-红色）
- **状态**：✓ 已完成

### 4.4 现代化的配色与布局 ✓

- **目标**：设计符合现代审美的 UI 界面，提升视觉效果和用户体验。
- **实现**：
  - **配色方案**：
    - 主色：绿色系 (#4CAF50) - 成功、活力
    - 辅助色：蓝色系 (#2196F3) - 专业、信任
    - 强调色：橙色 (#FF9800)、红色 (#f44336)
  - **渐变效果**：背景、按钮、进度条使用渐变色
  - **圆角设计**：12px（卡片）、8px（按钮、输入框）
  - **阴影效果**：0 2px 8px rgba(0, 0, 0, 0.08)
  - **字体优化**：
    - 中文：Microsoft YaHei UI
    - 英文：Segoe UI
    - 代码：Consolas
  - **布局优化**：
    - 卡片式分组
    - 合理的间距和内边距
    - 响应式布局
- **状态**：✓ 已完成

## 5. 总结

本实验通过实现 USB 总线和挂载设备的检测与操作，帮助学生深入理解 USB 设备的管理与文件操作。通过基础功能的稳定性保证和拓展功能的创新，展示了对系统编程和用户交互的综合掌握。同时，通过精美的界面设计，提升了用户体验，使整个实验项目具有更高的实用价值和美观度。

---
